<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reverb Origins Adornment Calculator (Updated)</title>
  <style>
    /* Root variables for easy theming */
    :root {
      --background-color: #111111;
      --surface-color: #1a1a1a;
      --primary-color: #c62828; /* deep red for primary UI elements */
      --accent-color: #ff9800; /* orange accent colour */
      --text-color: #f5f5f5;
      --border-color: #333333;
      --header-height: 60px;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      margin: 0;
      background-color: var(--background-color);
      color: var(--text-color);
      line-height: 1.5;
      font-size: 16px;
      overflow-x: hidden;
    }

    header {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: var(--text-color);
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border-bottom: 2px solid #000;
    }

    h1 {
      margin: 0;
      font-size: 32px;
      font-weight: 600;
      -webkit-text-stroke: 0.5px #000;
    }

    h2 {
      border-bottom: 1px solid #000;
      padding-bottom: 4px;
      margin-bottom: 10px;
    }

    .subheader {
      margin: 5px 0 0 0;
      font-size: 20px;
      font-weight: bold;
      color: #000;
      text-decoration: underline;
    }
    .subheader a {
      color: #000;
      text-decoration: underline;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }
    .filters label {
      font-weight: bold;
      margin-right: 8px;
    }
    select, input[type="text"], input[type="number"] {
      padding: 6px 8px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }

    thead {
      background-color: var(--primary-color);
      color: var(--surface-color);
      border-bottom: 2px solid #000;
    }
    thead th {
      border-left: 1px solid #000;
      border-right: 1px solid #000;
    }
    th, td {
      padding: 4px 6px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
      font-size: 14px;
      white-space: normal;
      word-break: break-word;
    }
    tbody tr:nth-child(odd) {
      background-color: #1e1e1e;
    }
    tbody tr:hover {
      background-color: #2a2a2a;
    }

    /* Calculator styles */
    .calculator {
      margin-top: 40px;
      padding: 20px;
      background-color: var(--surface-color);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    .calc-grid {
      overflow-x: auto;
    }
    .calc-table {
      width: 100%;
      border-collapse: collapse;
    }
    .calc-table th, .calc-table td {
      padding: 6px 8px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .calc-table th {
      background-color: var(--primary-color);
      color: white;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    .results {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .result-card {
      flex: 1;
      min-width: 200px;
      background-color: var(--surface-color);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }
    .result-card h3 {
      margin: 0 0 10px 0;
      font-size: 20px;
      color: var(--primary-color);
    }
    .result-card p {
      margin: 4px 0;
      font-size: 16px;
    }
    .result-card ul {
      list-style: none;
      margin: 4px 0 0 0;
      padding: 0;
    }
    .result-card li {
      font-size: 14px;
      line-height: 1.3;
    }
    /* Crafting summary styles */
    #crafting-summary-section table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    #crafting-summary-section th, #crafting-summary-section td {
      border: 1px solid var(--border-color);
      padding: 6px 8px;
      text-align: left;
      font-size: 14px;
    }
    /* Tier cell styling */
    .tier-cell {
      position: relative;
      width: 10%;
      min-width: 70px;
      padding: 4px 6px;
      vertical-align: middle;
      cursor: pointer;
      user-select: none;
    }
    .tier-cell .cell-count {
      position: absolute;
      top: 4px;
      left: 4px;
      font-size: 11px;
      background-color: #28a745;
      color: #fff;
      border-radius: 50%;
      padding: 1px 4px;
      display: none;
    }
    .hover-controls { display: none; }
    /* Info icon */
    .info-icon {
      display: inline-block;
      margin-left: 6px;
      width: 16px;
      height: 16px;
      line-height: 16px;
      text-align: center;
      border-radius: 50%;
      background-color: var(--accent-color);
      color: var(--surface-color);
      font-size: 12px;
      cursor: pointer;
      position: relative;
    }
    .info-icon:hover { opacity: 0.8; }
    /* Column width adjustments */
    #adornmentTable th:nth-child(1), #adornmentTable td:nth-child(1) { min-width: 90px; }
    #adornmentTable th:nth-child(2), #adornmentTable td:nth-child(2) { min-width: 120px; max-width: 160px; white-space: normal; word-break: break-word; }
    #adornmentTable th:nth-child(3), #adornmentTable td:nth-child(3) { min-width: 90px; }
    #adornmentTable th:nth-child(4), #adornmentTable td:nth-child(4) { min-width: 110px; }
    #adornmentTable th:nth-child(13), #adornmentTable td:nth-child(13) { min-width: 120px; max-width: 180px; white-space: normal; word-break: break-word; }
    #adornmentTableContainer {
      max-height: 400px;
      overflow-y: auto;
      overflow-x: auto;
    }
    /* Hide the smoldering (Tier 8) column when the Tier 8 toggle is off.  When the body
       has the class hide-smoldering, the Smoldering column is hidden entirely. */
    .hide-smoldering .smoldering-col { display: none; }

    /* Ensure the Smoldering column has enough horizontal space so its header and values
       do not wrap vertically.  Applying a minimum width to both header and data cells
       prevents the text from stacking and improves readability when the column is visible. */
    .smoldering-col {
      min-width: 80px;
      white-space: nowrap;
    }

    /* Toggle icon rotation and collapse behaviour for the calculator section */
    .toggle-icon {
      display: inline-block;
      margin-right: 6px;
      transition: transform 0.2s ease;
    }
    #calculator-section.collapsed .toggle-icon {
      transform: rotate(0deg);
    }
    #calculator-section:not(.collapsed) .toggle-icon {
      transform: rotate(90deg);
    }
    /* Hide calculator content when collapsed */
    #calculator-section.collapsed .calculator-content {
      display: none;
    }

    /* Prevent table headers from breaking mid-word */
    thead th {
      white-space: nowrap;
      word-break: normal;
    }
  </style>
</head>
<body class="hide-smoldering">
  <header>
    <h1>Reverb Origins Adornment Calculator</h1>
    <p class="subheader"><a href="https://discord.gg/reverb">Origins discussion at discord.gg/reverb</a></p>
    <p class="subheader"><a href="https://eq2classic.fandom.com/wiki/Transmuting" target="_blank">Transmuting guide on EQ2Classic</a></p>
  </header>
  <div class="container">
    <!-- Yield calculator section -->
    <section id="calculator-section" class="calculator collapsed" style="margin-top: 20px;">
      <h2 id="calc-header" class="section-header"><span class="toggle-icon">▶</span> Transmuting Yield Calculator
        <span class="info-icon" data-tooltip="Enter how many Treasured, Legendary and Fabled items you plan to transmute for each tier. Each transmute can produce either a single lower‑rarity component (75%), a single higher‑rarity component (20%) or one of each (5%). This tool multiplies your inputs by the resulting average yields (0.80 low and 0.25 high) and does not perform any material conversions. Click the header to expand or collapse the calculator.">i</span>
      </h2>
      <div class="calculator-content">
        <div class="calc-grid">
          <table class="calc-table" id="calcTable">
            <thead>
              <tr>
                <th>Tier</th>
                <th>Treasured<br>Items</th>
                <th>Legendary<br>Items</th>
                <th>Fabled<br>Items</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="results" id="calcResults"></div>
      </div>
    </section>
    <!-- Adornments lookup section -->
    <section id="adornments-section">
      <h2>Adornments Lookup
        <span class="info-icon" data-tooltip="Left click to add adornments to your list. Right click to remove. Use the dropdowns to filter by slot, tier and crafter. Use the keyword box to search across any column. The slot and tier filters take priority – search results only apply within the selected filters.">i</span>
      </h2>
      <div class="filters">
        <div>
          <label for="slotFilter">Slot:</label>
          <select id="slotFilter"></select>
        </div>
        <div>
          <label for="tierFilter">Tier:</label>
          <select id="tierFilter"></select>
        </div>
        <div>
          <label for="crafterFilter">Crafter:</label>
          <select id="crafterFilter"></select>
        </div>
        <div>
        <label for="keywordFilter">Keyword:</label>
        <input type="text" id="keywordFilter" placeholder="Type to search">
        </div>
        <div>
        <label><input type="checkbox" id="rokToggle"> ROK</label>
        </div>
      </div>
      <div id="adornmentTableContainer">
        <table id="adornmentTable">
          <thead>
            <tr>
              <th>Slot</th>
              <th>Name</th>
              <th>Made By</th>
              <th>Stat</th>
              <th>Flickering</th>
              <th>Shimmering</th>
              <th>Sparkling</th>
              <th>Glimmering</th>
              <th>Luminous</th>
              <th>Lambent</th>
              <th>Scintillating</th>
              <th class="smoldering-col">Smoldering</th>
              <th>Quality</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
    <!-- Crafting summary section -->
    <section id="crafting-summary-section" class="calculator" style="margin-top: 20px;">
      <h2 id="summary-header">Crafting Summary
        <span class="info-icon" data-tooltip="Left‑click a value in any tier column to add one of that adornment to your crafting list. Right‑click to remove one. This summary lists the selected adornments and the total quantities of each material required. Use the Export button inside to copy a summary to your clipboard.">i</span>
      </h2>
      <div class="summary-content">
        <div id="selectedList"></div>
        <button id="exportButton" class="export-btn">Export</button>
        <div id="craftingSummary"></div>
      </div>
    </section>
  </div>
  <!-- Tooltip overlay -->
  <div id="tooltipOverlay" class="tooltip-overlay">
    <div class="tooltip-box">
      <span class="close-btn"></span>
      <div id="tooltipContent" class="tooltip-text"></div>
    </div>
  </div>
  <script>
    // Flag to determine if ROK era (Tier 8) dataset should be visible.
    // When includeRok is false, the Smoldering column and items with only a Smoldering tier
    // will be hidden. There is no need to flag individual adornments; instead we compute
    // whether an item has any non‑Smoldering tier values on the fly.
    let includeRok = true;

    // Adornment data including Tier 8 values.  No reset of Smoldering values occurs here; all
    // tiers are preserved as specified in the dataset.  Items with only a Smoldering
    // value (and no other tier values) will be filtered out when includeRok is false.
    const adornmentsData = [
      { slot: "Any Weapon", name: "Magi's Second Sight", madeBy: "Tailor", stat: "Damage Spell Crit Chance", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: null, Smoldering: "2%", quality: "Fabled" },
      { slot: "Chest", name: "Mystic Applique", madeBy: "Alchemist", stat: "vs. Magic", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Legendary" },
      { slot: "Chest", name: "Prismatic Applique", madeBy: "Alchemist", stat: "Str/Sta/Agi/Wis/Int", Flickering: null, Shimmering: "1", Sparkling: "2", Glimmering: "3", Luminous: "4", Lambent: "5", Scintillating: "6", Smoldering: "7", quality: "Legendary" },
      { slot: "Chest", name: "Psychic Applique", madeBy: "Alchemist", stat: "vs. Mental", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Legendary" },
      { slot: "Chest", name: "Robust Applique", madeBy: "Alchemist", stat: "In-Combat Power Regen", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: "1", Lambent: null, Scintillating: null, Smoldering: null, quality: "Fabled" },
      { slot: "Cloak", name: "Silver Lining", madeBy: "Tailor", stat: "Reduced Falling Damage", Flickering: "5%", Shimmering: "10%", Sparkling: "15%", Glimmering: "20%", Luminous: "25%", Lambent: "30%", Scintillating: "35%", Smoldering: "40%", quality: "Treasured" },
      { slot: "Cloak", name: "Hygenic Lining", madeBy: "Provisioner", stat: "In-Combat Health Regen", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "1", Luminous: null, Lambent: "2", Scintillating: "3", Smoldering: "4", quality: "Legendary" },
      { slot: "Cloak", name: "Metaphysical Lining", madeBy: "Provisioner", stat: "In-Combat Power Regen", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "1", Luminous: null, Lambent: "2", Scintillating: "3", Smoldering: "4", quality: "Legendary" },
      { slot: "Crushing Weapon", name: "Molten Binding", madeBy: "Transmuter", stat: "Heat DoT (5%)", Flickering: "10/3", Shimmering: "99/12", Sparkling: "149/82", Glimmering: "193/23", Luminous: "236/27", Lambent: "272/33", Scintillating: "307/33", Smoldering: "407/41", quality: "Treasured" },
      { slot: "Crushing Weapon", name: "Molten Counterweight", madeBy: "Weaponsmith", stat: "Heat Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Crushing Weapon", name: "Viral Binding", madeBy: "Transmuter", stat: "Disease Proc & Slow (5%)", Flickering: "13/4.0%", Shimmering: "112/5.8%", Sparkling: "168/7.6%", Glimmering: "222/9.6%", Luminous: "268/11.8%", Lambent: "309/14.1%", Scintillating: "349/16.7%", Smoldering: "501/17.7%", quality: "Treasured" },
      { slot: "Crushing Weapon", name: "Viral Counterweight", madeBy: "Weaponsmith", stat: "Disease Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Crushing Weapon", name: "Weighted Counterweight", madeBy: "Weaponsmith", stat: "Crushing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Ear", name: "Arctic Backing", madeBy: "Jeweller", stat: "vs. Cold", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ear", name: "Fiery Backing", madeBy: "Jeweller", stat: "vs. Heat", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ear", name: "Holy Backing", madeBy: "Jeweller", stat: "vs. Divine", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "154", quality: "Treasured" },
      { slot: "Ear", name: "Intellectual Backing", madeBy: "Jeweller", stat: "Int", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Ear", name: "Mystic Backing", madeBy: "Jeweller", stat: "vs. Magic", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ear", name: "Psychic Backing", madeBy: "Jeweller", stat: "vs. Mental", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ear", name: "Septic Backing", madeBy: "Jeweller", stat: "vs. Disease", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ear", name: "Venom Laced Backing", madeBy: "Jeweller", stat: "vs. Poison", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Feet", name: "Agile Spurs", madeBy: "Armourer", stat: "Agi", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Feet", name: "Arctic Spurs", madeBy: "Armourer", stat: "vs. Cold", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Feet", name: "Gritty Spurs", madeBy: "Armourer", stat: "Sta", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Forearms", name: "Arctic Splint", madeBy: "Armourer", stat: "vs. Cold", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Forearms", name: "Glancing Splint", madeBy: "Armourer", stat: "Parry", Flickering: "1", Shimmering: "2", Sparkling: "3", Glimmering: "4", Luminous: "5", Lambent: "6", Scintillating: "7", Smoldering: "8", quality: "Fabled" },
      { slot: "Forearms", name: "Mystic Splint", madeBy: "Armourer", stat: "vs. Magic", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Forearms", name: "Reinforced Splint", madeBy: "Armourer", stat: "Mitigation", Flickering: "7", Shimmering: "17", Sparkling: "27", Glimmering: "37", Luminous: "47", Lambent: "57", Scintillating: "67", Smoldering: "77", quality: "Legendary" },
      { slot: "Forearms", name: "Savvy Splint", madeBy: "Armourer", stat: "Wis", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Hand", name: "Agile Stiching", madeBy: "Tailor", stat: "Agi", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Hand", name: "Fast Action Stiching", madeBy: "Tailor", stat: "Ranged Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: null, Smoldering: "2%", quality: "Fabled" },
      { slot: "Hand", name: "Occult Stitching", madeBy: "Tailor", stat: "Spell Damage", Flickering: null, Shimmering: null, Sparkling: "5", Glimmering: "10", Luminous: null, Lambent: "20", Scintillating: "25", Smoldering: "30", quality: "Fabled" },
      { slot: "Hand", name: "Restorative Stiching", madeBy: "Tailor", stat: "Heal Spells", Flickering: "10", Shimmering: "15", Sparkling: "20", Glimmering: "25", Luminous: "30", Lambent: "35", Scintillating: "40", Smoldering: "45", quality: "Legendary" },
      { slot: "Head", name: "Epiphanic Imprint", madeBy: "Tailor", stat: "Power", Flickering: "10", Shimmering: null, Sparkling: "30", Glimmering: null, Luminous: "50", Lambent: null, Scintillating: "100", Smoldering: null, quality: "Treasured" },
      { slot: "Head", name: "Psychic Imprint", madeBy: "Tailor", stat: "vs. Mental", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Head", name: "Savvy Imprint", madeBy: "Tailor", stat: "Wis", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Head", name: "Blessed Imprint", madeBy: "Tailor", stat: "Heal Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: null, Smoldering: "3%", quality: "Fabled" },
      { slot: "Legs", name: "Brawny Brace", madeBy: "Armourer", stat: "Str", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Legs", name: "Gritty Brace", madeBy: "Armourer", stat: "Sta", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Legs", name: "Septic Brace", madeBy: "Armourer", stat: "vs. Disease", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Legs", name: "Venom Laced Brace", madeBy: "Armourer", stat: "vs. Poison", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Neck", name: "Arcane Clasp", madeBy: "Jeweller", stat: "Heat Proc", Flickering: null, Shimmering: null, Sparkling: "3", Glimmering: "6", Luminous: "9", Lambent: "13", Scintillating: "17", Smoldering: "56", quality: "Fabled" },
      { slot: "Neck", name: "Consecrated Clasp", madeBy: "Jeweller", stat: "Ministration & Ordination", Flickering: null, Shimmering: null, Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "11", quality: "Legendary" },
      { slot: "Neck", name: "Judicious Clasp", madeBy: "Jeweller", stat: "Increase DPS", Flickering: null, Shimmering: "1", Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "12", quality: "Legendary" },
      { slot: "Neck", name: "Occult Clasp", madeBy: "Weaponsmith", stat: "Spell Damage", Flickering: null, Shimmering: null, Sparkling: "5", Glimmering: "10", Luminous: null, Lambent: "20", Scintillating: "25", Smoldering: "30", quality: "Fabled" },
      { slot: "Neck", name: "Restorative Clasp", madeBy: "Jeweller", stat: "Heal Spells", Flickering: "10", Shimmering: "15", Sparkling: "20", Glimmering: "25", Luminous: "30", Lambent: "35", Scintillating: "40", Smoldering: "45", quality: "Legendary" },
      { slot: "Neck", name: "Spry Clasp", madeBy: "Jeweller", stat: "Attack Speed", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1", Scintillating: "2", Smoldering: "3", quality: "Legendary" },
      { slot: "Neck", name: "Tactical Clasp", madeBy: "Jeweller", stat: "Melee Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: "1%", Smoldering: null, quality: "Fabled" },
      { slot: "One-Handed Crushing", name: "Concussive Counterbalance", madeBy: "Transmuter", stat: "Crushing", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Fabled" },
      { slot: "One-Handed Crushing", name: "Vigilant Counterbalance", madeBy: "Transmuter", stat: "Defence", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Fabled" },
      { slot: "One-Handed Piercing", name: "Glancing Tsuba", madeBy: "Transmuter", stat: "Parry", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Fabled" },
      { slot: "One-Handed Piercing", name: "Perforative Tsuba", madeBy: "Transmuter", stat: "Piercing", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Fabled" },
      { slot: "One-Handed Slashing", name: "Lacerative Ayr Stone", madeBy: "Transmuter", stat: "Slashing Skill", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Fabled" },
      { slot: "One-Handed Weapon", name: "Phantom Handle", madeBy: "Transmuter", stat: "Power Proc (10%)", Flickering: "26", Shimmering: "66", Sparkling: "99", Glimmering: "131", Luminous: "157", Lambent: "181", Scintillating: "205", Smoldering: "253", quality: "Legendary" },
      { slot: "One-Handed Weapon", name: "Vampiric Handle", madeBy: "Transmuter", stat: "Health Proc (10%)", Flickering: "26", Shimmering: "66", Sparkling: "99", Glimmering: "131", Luminous: "158", Lambent: "181", Scintillating: "205", Smoldering: "274", quality: "Legendary" },
      { slot: "Piercing Weapon", name: "Honed Crossguard", madeBy: "Weaponsmith", stat: "Piercing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Piercing Weapon", name: "Runic Crossguard", madeBy: "Weaponsmith", stat: "Magic Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Piercing Weapon", name: "Runic Temper", madeBy: "Transmuter", stat: "Magic DoT Proc (5%)", Flickering: "4", Shimmering: "36", Sparkling: "53", Glimmering: "71", Luminous: "85", Lambent: "98", Scintillating: "111", Smoldering: "251", quality: "Treasured" },
      { slot: "Piercing Weapon", name: "Serpentine Crossguard", madeBy: "Weaponsmith", stat: "Poison Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Piercing Weapon", name: "Serpentine Temper", madeBy: "Transmuter", stat: "Poison DoT Proc (5%)", Flickering: "4", Shimmering: "36", Sparkling: "53", Glimmering: "71", Luminous: "85", Lambent: "98", Scintillating: "111", Smoldering: "251", quality: "Treasured" },
      { slot: "Piercing Weapon", name: "Viral Crossguard", madeBy: "Weaponsmith", stat: "Disease Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Piercing Weapon", name: "Viral Temper", madeBy: "Transmuter", stat: "Disease Proc & Slow (5%)", Flickering: "13/4.0%", Shimmering: "112/5.8%", Sparkling: "168/7.6%", Glimmering: "222/9.6%", Luminous: "268/11.8%", Lambent: "309/14.1%", Scintillating: "349/16.7%", Smoldering: "501/17.7%", quality: "Treasured" },
      { slot: "Primary", name: "Clemency of the Pontiff", madeBy: "Armourer", stat: "Heal Spells", Flickering: "10", Shimmering: "15", Sparkling: "20", Glimmering: "25", Luminous: "30", Lambent: "35", Scintillating: "40", Smoldering: "45", quality: "Legendary" },
      { slot: "Primary", name: "Focus of the Pontiff", madeBy: "Alchemist", stat: "Power Proc on Heal (5%)", Flickering: null, Shimmering: null, Sparkling: "17", Glimmering: "28", Luminous: "44", Lambent: "63", Scintillating: "85", Smoldering: "102", quality: "Fabled" },
      { slot: "Primary", name: "Balanced Ayr Stone", madeBy: "Transmuter", stat: "Ripost/Parry", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: "2%", Smoldering: "3%", quality: "Fabled" },
      { slot: "Primary", name: "Pontiff's Second Sight", madeBy: "Provisioner", stat: "Heal Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: "1%", Smoldering: "3%", quality: "Fabled" },
      { slot: "Primary", name: "Focus of the Magi", madeBy: "Sage", stat: "Power Proc (5%)", Flickering: null, Shimmering: null, Sparkling: "17", Glimmering: "28", Luminous: "44", Lambent: "63", Scintillating: "85", Smoldering: "102", quality: "Fabled" },
      { slot: "Primary", name: "Finesse of the Pontiff", madeBy: "Woodworker", stat: "AE Decrease Threat (5%)", Flickering: null, Shimmering: null, Sparkling: "172", Glimmering: "334", Luminous: "574", Lambent: "897", Scintillating: "1296", Smoldering: "1617", quality: "Fabled" },
      { slot: "Primary", name: "Finesse of the Magi", madeBy: "Carpenter", stat: "AE Decrease Threat (5%)", Flickering: null, Shimmering: null, Sparkling: "172", Glimmering: "334", Luminous: "574", Lambent: "897", Scintillating: "1296", Smoldering: "1617", quality: "Fabled" },
      { slot: "Bow", name: "Enchanted Sinew", madeBy: "Woodworker", stat: "Slashing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Bow", name: "Strengthened Sinew", madeBy: "Woodworker", stat: "Piercing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Bow", name: "Serpentine Composite Gear", madeBy: "Tinker", stat: "Poison Damage", Flickering: null, Shimmering: null, Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Bow", name: "Glacial Composite Gear", madeBy: "Tinker", stat: "Cold Damage", Flickering: null, Shimmering: null, Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Bow", name: "Judicious Composite Gear", madeBy: "Tinker", stat: "Damage per Second", Flickering: "0.8", Shimmering: "1", Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "12", quality: "Fabled" },
      { slot: "Bow", name: "Molten Composite Gear", madeBy: "Tinker", stat: "Heat Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: null, Smoldering: "14", quality: "Treasured" },
      { slot: "Bow", name: "Vampiric Composite Gear", madeBy: "Tinker", stat: "Divine Damage & Heal", Flickering: null, Shimmering: "43/40", Sparkling: "63/60", Glimmering: "84/80", Luminous: "105/100", Lambent: "125/120", Scintillating: "149/140", Smoldering: "274/184", quality: "Legendary" },
      { slot: "Throwing Weapon", name: "Honing Easyloader", madeBy: "Tailor", stat: "Piercing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Throwing Weapon", name: "Judicious Easyloader", madeBy: "Tailor", stat: "DPS", Flickering: null, Shimmering: "1", Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "12", quality: "Fabled" },
      { slot: "Throwing Weapon", name: "Phantom Easyloader", madeBy: "Tailor", stat: "Power Tap & Buff (10%)", Flickering: "26/16", Shimmering: "48/40", Sparkling: "68/60", Glimmering: "90/80", Luminous: "113/100", Lambent: "135/120", Scintillating: "158/140", Smoldering: "253/170", quality: "Legendary" },
      { slot: "Throwing Weapon", name: "Righteous Easyloader", madeBy: "Tailor", stat: "Divine Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Throwing Weapon", name: "Sharpening Easyloader", madeBy: "Tailor", stat: "Slashing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Throwing Weapon", name: "Weighted Easyloader", madeBy: "Tailor", stat: "Crushing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Ring", name: "Arctic Polish", madeBy: "Alchemist", stat: "vs. Cold", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ring", name: "Epiphanic Polish", madeBy: "Alchemist", stat: "Power", Flickering: null, Shimmering: "20", Sparkling: null, Glimmering: "40", Luminous: null, Lambent: "70", Scintillating: null, Smoldering: "100", quality: "Treasured" },
      { slot: "Ring", name: "Fiery Polish", madeBy: "Alchemist", stat: "vs. Heat", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ring", name: "Holy Polish", madeBy: "Alchemist", stat: "vs. Divine", Flickering: "14", Shimmering: "34", Sparkling: "54", Glimmering: "74", Luminous: "94", Lambent: "114", Scintillating: "134", Smoldering: "154", quality: "Treasured" },
      { slot: "Ring", name: "Mystic Polish", madeBy: "Alchemist", stat: "vs. Magic", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ring", name: "Psychic Polish", madeBy: "Alchemist", stat: "vs. Mental", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ring", name: "Rugged Polish", madeBy: "Alchemist", stat: "Health", Flickering: null, Shimmering: "20", Sparkling: null, Glimmering: "40", Luminous: null, Lambent: "70", Scintillating: null, Smoldering: "100", quality: "Treasured" },
      { slot: "Ring", name: "Septic Polish", madeBy: "Alchemist", stat: "vs. Disease", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Ring", name: "Thriving Polish", madeBy: "Alchemist", stat: "Health/Power", Flickering: null, Shimmering: "10", Sparkling: null, Glimmering: "20", Luminous: null, Lambent: "35", Scintillating: null, Smoldering: "60", quality: "Fabled" },
      { slot: "Ring", name: "Venom Laced Polish", madeBy: "Alchemist", stat: "vs. Poison", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Shield", name: "Balanced Strut", madeBy: "Woodworker", stat: "Block", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: null, Smoldering: null, quality: "Fabled" },
      { slot: "Shield", name: "Blessed Strut", madeBy: "Woodworker", stat: "Heal Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: "1%", Lambent: null, Scintillating: null, Smoldering: null, quality: "Fabled" },
      { slot: "Shield", name: "Intercepting Strut", madeBy: "Woodworker", stat: "Heal Proc", Flickering: "1% 8-10", Shimmering: "2% 21-25", Sparkling: "3% 30-36", Glimmering: "4% 42-51", Luminous: "6% 60-73", Lambent: "8% 76-92", Scintillating: "10% 91-111", Smoldering: "10% 124-152", quality: "Legendary" },
      { slot: "Shield", name: "Reinforced Strut", madeBy: "Woodworker", stat: "Mitigation", Flickering: "7", Shimmering: "17", Sparkling: "27", Glimmering: "37", Luminous: "47", Lambent: "57", Scintillating: "67", Smoldering: "77", quality: "Legendary" },
      { slot: "Shield", name: "Spiked Strut", madeBy: "Woodworker", stat: "Damage Shield", Flickering: "6", Shimmering: "14", Sparkling: "23", Glimmering: "33", Luminous: "45", Lambent: "55", Scintillating: "65", Smoldering: "76", quality: "Legendary" },
      { slot: "Shield", name: "Tactical Strut", madeBy: "Woodworker", stat: "Melee Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1%", Scintillating: null, Smoldering: "2%", quality: "Fabled" },
      { slot: "Shoulder", name: "Brawny Straps", madeBy: "Tailor", stat: "Str", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Shoulder", name: "Gritty Straps", madeBy: "Tailor", stat: "Sta", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Shoulder", name: "Rugged Straps", madeBy: "Tailor", stat: "Health", Flickering: "10", Shimmering: null, Sparkling: "30", Glimmering: null, Luminous: "50", Lambent: null, Scintillating: "100", Smoldering: null, quality: "Treasured" },
      { slot: "Shoulder", name: "Septic Straps", madeBy: "Tailor", stat: "vs. Disease", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Shoulder", name: "Spiked Straps", madeBy: "Tailor", stat: "Damage Shield", Flickering: "5", Shimmering: "10", Sparkling: "16", Glimmering: "23", Luminous: "31", Lambent: "39", Scintillating: "48", Smoldering: "76", quality: "Legendary" },
      { slot: "Shoulder", name: "Venom Laced Straps", madeBy: "Tailor", stat: "vs. Poison", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Slashing Weapon", name: "Glacial Temper", madeBy: "Transmuter", stat: "Slow & Cold Proc (5%)", Flickering: "12% 13", Shimmering: "17% 112", Sparkling: "21% 168", Glimmering: "26% 222", Luminous: "32% 286", Lambent: "37% 309", Scintillating: "43% 348", Smoldering: "45% 501", quality: "Treasured" },
      { slot: "Slashing Weapon", name: "Glacial Whetstone", madeBy: "Weaponsmith", stat: "Cold Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Slashing Weapon", name: "Molten Temper", madeBy: "Transmuter", stat: "Heat DoT (5%)", Flickering: "10/3", Shimmering: "99/12", Sparkling: "149/82", Glimmering: "193/23", Luminous: "236/27", Lambent: "272/33", Scintillating: "307/33", Smoldering: "407/41", quality: "Treasured" },
      { slot: "Slashing Weapon", name: "Molten Whetstone", madeBy: "Weaponsmith", stat: "Heat Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Slashing Weapon", name: "Righteous Temper", madeBy: "Transmuter", stat: "Proc: Divine + Heal (5%)", Flickering: "13/4", Shimmering: "112/12", Sparkling: "168/22", Glimmering: "222/24", Luminous: "268/30", Lambent: "309/36", Scintillating: "348/42", Smoldering: "465/55", quality: "Treasured" },
      { slot: "Slashing Weapon", name: "Righteous Whetstone", madeBy: "Weaponsmith", stat: "Divine Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Legendary" },
      { slot: "Slashing Weapon", name: "Sharpening Whetstone", madeBy: "Weaponsmith", stat: "Slashing Damage", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "12", Smoldering: "14", quality: "Treasured" },
      { slot: "Symbol", name: "Arcane Ornament", madeBy: "Carpenter", stat: "All Arcane Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "5", Luminous: "10", Lambent: "20", Scintillating: "25", Smoldering: "30", quality: "Fabled" },
      { slot: "Symbol", name: "Archmage's Ornament", madeBy: "Carpenter", stat: "Disruption & Subjugation", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Legendary" },
      { slot: "Symbol", name: "Elemental Ornament", madeBy: "Carpenter", stat: "All Elemental Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "5", Luminous: "10", Lambent: "20", Scintillating: "25", Smoldering: "30", quality: "Fabled" },
      { slot: "Symbol", name: "Glacial Ornament", madeBy: "Carpenter", stat: "Cold Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Fabled" },
      { slot: "Symbol", name: "Metaphysical Ornament", madeBy: "Carpenter", stat: "In-Combat Power Regen", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "1", Luminous: null, Lambent: null, Scintillating: null, Smoldering: "2", quality: "Legendary" },
      { slot: "Symbol", name: "Molten Ornament", madeBy: "Carpenter", stat: "Heat Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Symbol", name: "Noxious Ornament", madeBy: "Carpenter", stat: "All Noxious Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "5", Luminous: "10", Lambent: "20", Scintillating: "25", Smoldering: "30", quality: "Fabled" },
      { slot: "Symbol", name: "Occult Ornament", madeBy: "Carpenter", stat: "All Spell Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: "15", Lambent: null, Scintillating: null, Smoldering: null, quality: "Fabled" },
      { slot: "Symbol", name: "Righteous Ornament", madeBy: "Carpenter", stat: "Divine Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Symbol", name: "Runic Ornament", madeBy: "Carpenter", stat: "Magic Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Symbol", name: "Serpentine Ornament", madeBy: "Carpenter", stat: "Poison Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Symbol", name: "Spellbound Ornament", madeBy: "Carpenter", stat: "Crit Chance to Damage Spells", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: "1%", Smoldering: null, quality: "Fabled" },
      { slot: "Symbol", name: "Telekinetic Ornament", madeBy: "Carpenter", stat: "Mental Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Symbol", name: "Viral Ornament", madeBy: "Carpenter", stat: "Disease Damage", Flickering: null, Shimmering: "5", Sparkling: "10", Glimmering: "20", Luminous: "30", Lambent: "40", Scintillating: "45", Smoldering: "50", quality: "Legendary" },
      { slot: "Two-Handed Crushing", name: "Phantom Shod", madeBy: "Transmuter", stat: "Power Tap & Buff (10%)", Flickering: "26/16", Shimmering: "66/40", Sparkling: "99/60", Glimmering: "131/80", Luminous: "158/100", Lambent: "181/120", Scintillating: "205/140", Smoldering: "253/170", quality: "Legendary" },
      { slot: "Two-Handed Crushing", name: "Vigilant Shod", madeBy: "Transmuter", stat: "Defence", Flickering: null, Shimmering: "1", Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "11", quality: "Fabled" },
      { slot: "Two-Handed Piercing", name: "Proficient Shaft", madeBy: "Transmuter", stat: "Double Attack", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: "1%", Lambent: "2%", Scintillating: "3%", Smoldering: "4%", quality: "Fabled" },
      { slot: "Two-Handed Piercing", name: "Vigilant Shaft", madeBy: "Transmuter", stat: "Defence", Flickering: null, Shimmering: "1", Sparkling: "2", Glimmering: "4", Luminous: "6", Lambent: "8", Scintillating: "10", Smoldering: "11", quality: "Fabled" },
      { slot: "Two-Handed Slashing", name: "Deft Pommel", madeBy: "Transmuter", stat: "Chance to AoE Slash", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: "1%", Lambent: "2%", Scintillating: "3%", Smoldering: "4%", quality: "Fabled" },
      { slot: "Two-Handed Slashing", name: "Vampiric Pommel", madeBy: "Transmuter", stat: "Divine Damage & Heal Proc (10%)", Flickering: "26/16", Shimmering: "66/40", Sparkling: "99/60", Glimmering: "131/80", Luminous: "158/100", Lambent: "181/120", Scintillating: "205/140", Smoldering: "274/184", quality: "Legendary" },
      { slot: "Two-Handed Weapon", name: "Rapid Handgrips", madeBy: "Transmuter", stat: "Attack Speed", Flickering: null, Shimmering: null, Sparkling: "2", Glimmering: "5", Luminous: "10", Lambent: "15", Scintillating: "20", Smoldering: "25", quality: "Fabled" },
      { slot: "Waist", name: "Archmage's Buckle", madeBy: "Armourer", stat: "Disruption & Subjugation", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: "2", Luminous: "3", Lambent: "4", Scintillating: "5", Smoldering: "6", quality: "Legendary" },
      { slot: "Waist", name: "Combative Buckle", madeBy: "Armourer", stat: "Combat Art Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: null, Smoldering: "30", quality: "Fabled" },
      { slot: "Waist", name: "Fast Action Buckle", madeBy: "Armourer", stat: "Ranged Crit", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: "1%", Smoldering: null, quality: "Fabled" },
      { slot: "Waist", name: "Spry Buckle", madeBy: "Armourer", stat: "Attack Speed", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: "1", Scintillating: "2", Smoldering: "3", quality: "Legendary" },
      { slot: "Wrist", name: "Agile Fastening", madeBy: "Alchemist", stat: "Agi", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Wrist", name: "Balanced Fastening", madeBy: "Sage", stat: "Block", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: "1%", Smoldering: "3%", quality: "Fabled" },
      { slot: "Wrist", name: "Brawny Fastening", madeBy: "Provisioner", stat: "Str", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Wrist", name: "Combative Buckle", madeBy: "Alchemist", stat: "Combat Art Damage", Flickering: null, Shimmering: null, Sparkling: null, Glimmering: null, Luminous: null, Lambent: null, Scintillating: null, Smoldering: "30", quality: "Fabled" },
      { slot: "Wrist", name: "Diverting Fastening", madeBy: "Jeweller", stat: "Heal on Deflection", Flickering: "1% 7-9", Shimmering: "2% 18-22", Sparkling: "3% 30-36", Glimmering: "4% 42-51", Luminous: "6% 57-69", Lambent: "8% 72-88", Scintillating: "10% 88-107", Smoldering: "10% 124-152", quality: "Fabled" },
      { slot: "Wrist", name: "Fiery Fastening", madeBy: "Provisioner", stat: "vs. Heat", Flickering: "10", Shimmering: "25", Sparkling: "40", Glimmering: "55", Luminous: "70", Lambent: "85", Scintillating: "100", Smoldering: "115", quality: "Treasured" },
      { slot: "Wrist", name: "Gritty Fastening", madeBy: "Woodworker", stat: "Sta", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Wrist", name: "Hygenic Fastening", madeBy: "Armourer", stat: "Health Regen", Flickering: null, Shimmering: null, Sparkling: "1", Glimmering: null, Luminous: "2", Lambent: null, Scintillating: "3", Smoldering: null, quality: "Legendary" },
      { slot: "Wrist", name: "Intellectual Fastening", madeBy: "Tailor", stat: "Int", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" },
      { slot: "Wrist", name: "Oscillating Fastening", madeBy: "Jeweller", stat: "Heal on Parry", Flickering: "1% 7-9", Shimmering: "2% 18-22", Sparkling: "3% 30-36", Glimmering: "4% 42-51", Luminous: "6% 57-69", Lambent: "8% 72-88", Scintillating: "10% 88-107", Smoldering: "10% 124-152", quality: "Fabled" },
      { slot: "Wrist", name: "Reactive Fastening", madeBy: "Jeweller", stat: "Heal on Ripost", Flickering: "1% 7-9", Shimmering: "2% 18-22", Sparkling: "3% 30-36", Glimmering: "4% 42-51", Luminous: "6% 57-69", Lambent: "8% 72-88", Scintillating: "10% 88-107", Smoldering: "10% 124-152", quality: "Fabled" },
      { slot: "Wrist", name: "Reinforced Fastening", madeBy: "Carpenter", stat: "Mitigation", Flickering: "7", Shimmering: "17", Sparkling: "27", Glimmering: "37", Luminous: "47", Lambent: "57", Scintillating: "67", Smoldering: "77", quality: "Legendary" },
      { slot: "Wrist", name: "Savvy Fastening", madeBy: "Carpenter", stat: "Wis", Flickering: "1", Shimmering: "2", Sparkling: "4", Glimmering: "6", Luminous: "8", Lambent: "10", Scintillating: "14", Smoldering: "16", quality: "Treasured" }
    ];

    // Transmuted yield data with Tier 8 added
    const transmutedData = [
      { tier: "Flickering", treasured: { powder: 1, fragment: 2 }, legendary: { powder: 1, fragment: 1, infusion: 1 }, fabled: { powder: 1, fragment: 1, infusion: 1, mana: 1 } },
      { tier: "Shimmering", treasured: { powder: 1, fragment: 3 }, legendary: { powder: 2, fragment: 2, infusion: 1 }, fabled: { powder: 1, fragment: 1, infusion: 1, mana: 1 } },
      { tier: "Sparkling", treasured: { powder: 1, fragment: 5 }, legendary: { powder: 2, fragment: 3, infusion: 1 }, fabled: { powder: 2, fragment: 2, infusion: 1, mana: 1 } },
      { tier: "Glimmering", treasured: { powder: 1, fragment: 6 }, legendary: { powder: 4, fragment: 3, infusion: 1 }, fabled: { powder: 3, fragment: 3, infusion: 1, mana: 1 } },
      { tier: "Luminous", treasured: { powder: 1, fragment: 8 }, legendary: { powder: 5, fragment: 4, infusion: 1 }, fabled: { powder: 2, fragment: 4, infusion: 2, mana: 1 } },
      { tier: "Lambent", treasured: { powder: 1, fragment: 9 }, legendary: { powder: 6, fragment: 5, infusion: 1 }, fabled: { powder: 6, fragment: 5, infusion: 2, mana: 1 } },
      { tier: "Scintillating", treasured: { powder: 1, fragment: 9 }, legendary: { powder: 8, fragment: 5, infusion: 1 }, fabled: { powder: 8, fragment: 5, infusion: 2, mana: 1 } },
      { tier: "Smoldering", treasured: { powder: 1, fragment: 9 }, legendary: { powder: 8, fragment: 5, infusion: 1 }, fabled: { powder: 8, fragment: 5, infusion: 2, mana: 1 } }
    ];

    // Materials required for crafting including Tier 8 materials
    const materialData = [
      {
        tier: 'Flickering',
        materials: {
          mana: { name: 'Refined', counts: { fabled: 1 } },
          infusion: { name: 'Earth', counts: { legendary: 1, fabled: 1 } },
          powder: { name: 'Ulteran', counts: { treasured: 1, legendary: 1, fabled: 1 } },
          fragment: { name: 'Lapis Lazuli', counts: { treasured: 2, legendary: 1, fabled: 1 } }
        }
      },
      {
        tier: 'Shimmering',
        materials: {
          mana: { name: 'Processed', counts: { fabled: 1 } },
          infusion: { name: 'Air', counts: { legendary: 1, fabled: 1 } },
          powder: { name: 'Aether', counts: { treasured: 1, legendary: 2, fabled: 1 } },
          fragment: { name: 'Coral', counts: { treasured: 3, legendary: 2, fabled: 1 } }
        }
      },
      {
        tier: 'Sparkling',
        materials: {
          mana: { name: 'Clarified', counts: { fabled: 1 } },
          infusion: { name: 'Fire', counts: { legendary: 1, fabled: 1 } },
          powder: { name: 'Phantom', counts: { treasured: 1, legendary: 2, fabled: 2 } },
          fragment: { name: 'Jasper', counts: { treasured: 5, legendary: 3, fabled: 2 } }
        }
      },
      {
        tier: 'Glimmering',
        materials: {
          mana: { name: 'Purified', counts: { fabled: 1 } },
          infusion: { name: 'Water', counts: { legendary: 1, fabled: 1 } },
          powder: { name: 'Ethereal', counts: { treasured: 1, legendary: 4, fabled: 3 } },
          fragment: { name: 'Opal', counts: { treasured: 6, legendary: 3, fabled: 3 } }
        }
      },
      {
        tier: 'Luminous',
        materials: {
          mana: { name: 'Natural', counts: { fabled: 1 } },
          infusion: { name: 'Nightmare', counts: { legendary: 1, fabled: 2 } },
          powder: { name: 'Spectral', counts: { treasured: 1, legendary: 5, fabled: 2 } },
          fragment: { name: 'Ruby', counts: { treasured: 8, legendary: 4, fabled: 4 } }
        }
      },
      {
        tier: 'Lambent',
        materials: {
          mana: { name: 'Coalesced', counts: { fabled: 1 } },
          infusion: { name: 'Daydream', counts: { legendary: 1, fabled: 2 } },
          powder: { name: 'Vision', counts: { treasured: 1, legendary: 6, fabled: 6 } },
          fragment: { name: 'Pearl', counts: { treasured: 9, legendary: 5, fabled: 5 } }
        }
      },
      {
        tier: 'Scintillating',
        materials: {
          mana: { name: 'Hardened', counts: { fabled: 1 } },
          infusion: { name: 'Illusion', counts: { legendary: 1, fabled: 2 } },
          powder: { name: 'Illusionary', counts: { treasured: 1, legendary: 8, fabled: 8 } },
          fragment: { name: 'Lunar', counts: { treasured: 9, legendary: 5, fabled: 5 } }
        }
      },
      {
        tier: 'Smoldering',
        materials: {
          mana: { name: 'Crystallized', counts: { fabled: 1 } },
          infusion: { name: 'Reality', counts: { legendary: 1, fabled: 2 } },
          powder: { name: 'Sacred', counts: { treasured: 1, legendary: 8, fabled: 8 } },
          fragment: { name: 'Emerald', counts: { treasured: 9, legendary: 5, fabled: 5 } }
        }
      }
    ];

    // Track counts of each adornment and tier
    const itemCounts = {};
    const materialsCartTotals = materialData.map(() => ({ mana: 0, infusion: 0, powder: 0, fragment: 0 }));
    const itemCountsByTier = [];

    function addItemToCart(idx, tierName) {
      if (!itemCountsByTier[idx]) itemCountsByTier[idx] = {};
      itemCountsByTier[idx][tierName] = (itemCountsByTier[idx][tierName] || 0) + 1;
      const tierIndex = materialData.findIndex(t => t.tier === tierName);
      if (tierIndex === -1) return;
      const quality = adornmentsData[idx].quality.toLowerCase();
      const tierMaterials = materialData[tierIndex].materials;
      Object.keys(tierMaterials).forEach(matKey => {
        const amount = tierMaterials[matKey].counts[quality] || 0;
        materialsCartTotals[tierIndex][matKey] += amount;
      });
      updateCellCountBadge(idx, tierName);
      renderCraftingSummary();
    }

    function removeItemFromCart(idx, tierName) {
      if (!itemCountsByTier[idx] || !itemCountsByTier[idx][tierName] || itemCountsByTier[idx][tierName] <= 0) return;
      itemCountsByTier[idx][tierName] -= 1;
      const tierIndex = materialData.findIndex(t => t.tier === tierName);
      if (tierIndex === -1) return;
      const quality = adornmentsData[idx].quality.toLowerCase();
      const tierMaterials = materialData[tierIndex].materials;
      Object.keys(tierMaterials).forEach(matKey => {
        const amount = tierMaterials[matKey].counts[quality] || 0;
        materialsCartTotals[tierIndex][matKey] -= amount;
        if (materialsCartTotals[tierIndex][matKey] < 0) materialsCartTotals[tierIndex][matKey] = 0;
      });
      updateCellCountBadge(idx, tierName);
      renderCraftingSummary();
    }

    function updateCellCountBadge(idx, tierName) {
      const badge = document.querySelector('span.cell-count[data-idx="' + idx + '"][data-tier="' + tierName + '"]');
      if (!badge) return;
      const count = (itemCountsByTier[idx] && itemCountsByTier[idx][tierName]) || 0;
      if (count > 0) {
        badge.textContent = count;
        badge.style.display = 'inline-block';
      } else {
        badge.style.display = 'none';
      }
    }

    function addToCart(idx) {
      const tierSelect = document.getElementById('tierFilter');
      const selectedTier = tierSelect.value;
      if (selectedTier === 'All') {
        alert('Please select a specific tier (T1–T8) using the Tier filter before adding items to your crafting list.');
        return;
      }
      itemCounts[idx] = (itemCounts[idx] || 0) + 1;
      const tierIndex = materialData.findIndex(t => t.tier === selectedTier);
      if (tierIndex === -1) return;
      const quality = adornmentsData[idx].quality.toLowerCase();
      const tierMaterials = materialData[tierIndex].materials;
      Object.keys(tierMaterials).forEach(matKey => {
        const amount = tierMaterials[matKey].counts[quality] || 0;
        materialsCartTotals[tierIndex][matKey] += amount;
      });
      updateItemCountDisplay(idx);
      renderCraftingSummary();
    }

    function removeFromCart(idx) {
      const tierSelect = document.getElementById('tierFilter');
      const selectedTier = tierSelect.value;
      if (selectedTier === 'All') {
        alert('Please select a specific tier (T1–T8) using the Tier filter before removing items from your crafting list.');
        return;
      }
      if (!itemCounts[idx] || itemCounts[idx] <= 0) return;
      itemCounts[idx] -= 1;
      const tierIndex = materialData.findIndex(t => t.tier === selectedTier);
      if (tierIndex === -1) return;
      const quality = adornmentsData[idx].quality.toLowerCase();
      const tierMaterials = materialData[tierIndex].materials;
      Object.keys(tierMaterials).forEach(matKey => {
        const amount = tierMaterials[matKey].counts[quality] || 0;
        materialsCartTotals[tierIndex][matKey] -= amount;
        if (materialsCartTotals[tierIndex][matKey] < 0) materialsCartTotals[tierIndex][matKey] = 0;
      });
      updateItemCountDisplay(idx);
      renderCraftingSummary();
    }

    function updateItemCountDisplay(idx) {
      const span = document.querySelector('span.item-count[data-index="' + idx + '"]');
      if (span) span.textContent = itemCounts[idx] || 0;
    }

    function renderCraftingSummary() {
      const container = document.getElementById('craftingSummary');
      const anySelected = materialsCartTotals.some(t => t.mana > 0 || t.infusion > 0 || t.powder > 0 || t.fragment > 0);
      let html = '<table><thead><tr><th>Tier</th><th>Mana</th><th>Infusion</th><th>Powder</th><th>Fragment</th></tr></thead><tbody>';
      let rowsAdded = 0;
      if (anySelected) {
        materialsCartTotals.forEach((totals, tierIndex) => {
          const tier = materialData[tierIndex];
          if (totals.mana === 0 && totals.infusion === 0 && totals.powder === 0 && totals.fragment === 0) return;
          html += '<tr>';
          html += '<td>T' + (tierIndex + 1) + ' ' + tier.tier + '</td>';
          ['mana','infusion','powder','fragment'].forEach(matKey => {
            const matName = tier.materials[matKey].name;
            const count = totals[matKey] || 0;
            html += '<td>' + (count > 0 ? (count + ' ' + matName) : '') + '</td>';
          });
          html += '</tr>';
          rowsAdded++;
        });
      }
      // Add placeholder rows up to 2 for consistent table height
      for (let i = 0; rowsAdded + i < 2; i++) {
        const tierIndex = rowsAdded + i;
        if (tierIndex >= materialData.length) break;
        const tier = materialData[tierIndex];
        html += '<tr><td>T' + (tierIndex + 1) + ' ' + tier.tier + '</td>';
        ['mana','infusion','powder','fragment'].forEach(() => { html += '<td></td>'; });
        html += '</tr>';
      }
      html += '</tbody></table>';
      container.innerHTML = html;
      updateSelectedList();
    }

    function updateSelectedList() {
      const listDiv = document.getElementById('selectedList');
      if (!listDiv) return;
      const grouped = {};
      adornmentsData.forEach((item, idx) => {
        const counts = itemCountsByTier[idx];
        if (!counts) return;
        const crafter = item.madeBy || 'Unknown';
        Object.keys(counts).forEach(tierName => {
          const count = counts[tierName];
          if (count > 0) {
            const value = (item[tierName] !== null && item[tierName] !== undefined) ? item[tierName] : '';
            const statFormatted = item.stat ? item.stat.replace(/vs\./gi, 'Versus') : '';
            let detail;
            if (value !== '') {
              detail = `${item.slot}, ${value} ${statFormatted}`.trim();
            } else {
              detail = `${item.slot}${statFormatted ? ', ' + statFormatted : ''}`.trim();
            }
            const text = `${count} ${tierName} ${item.name} (${detail})`;
            if (!grouped[crafter]) grouped[crafter] = [];
            grouped[crafter].push({ idx, tierName, text });
          }
        });
      });
      const crafterNames = Object.keys(grouped);
      if (crafterNames.length === 0) {
        listDiv.textContent = 'No adornments selected';
      } else {
        let html = '';
        crafterNames.sort().forEach(crafter => {
          html += `<div class="crafter-heading">### ${crafter}</div>`;
          grouped[crafter].forEach(entry => {
            const removeBtn = `<span class="remove-item" data-idx="${entry.idx}" data-tier="${entry.tierName}">&times;</span>`;
            html += `<div>${removeBtn}${entry.text}</div>`;
          });
        });
        listDiv.innerHTML = html;
        listDiv.querySelectorAll('.remove-item').forEach(el => {
          el.addEventListener('click', evt => {
            evt.stopPropagation();
            const idxStr = el.getAttribute('data-idx');
            const tierStr = el.getAttribute('data-tier');
            if (idxStr !== null && tierStr !== null) {
              const idxNum = parseInt(idxStr, 10);
              removeItemFromCart(idxNum, tierStr);
            }
          });
        });
      }
    }

    function initFilters() {
      const slotSelect = document.getElementById('slotFilter');
      const tierSelect = document.getElementById('tierFilter');
      const crafterSelect = document.getElementById('crafterFilter');
      const slots = Array.from(new Set(adornmentsData.map(d => d.slot))).sort();
      slots.unshift('All');
      slots.forEach(slot => {
        const option = document.createElement('option');
        option.value = slot;
        option.textContent = slot;
        slotSelect.appendChild(option);
      });
      const allOption = document.createElement('option');
      allOption.value = 'All';
      allOption.textContent = 'All';
      tierSelect.appendChild(allOption);
      transmutedData.forEach((t, i) => {
        const option = document.createElement('option');
        option.value = t.tier;
        option.textContent = 'T' + (i + 1) + ' ' + t.tier;
        tierSelect.appendChild(option);
      });
      const crafters = Array.from(new Set(adornmentsData.map(d => d.madeBy).filter(Boolean))).sort();
      crafters.unshift('All');
      crafters.forEach(crafter => {
        const option = document.createElement('option');
        option.value = crafter;
        option.textContent = crafter;
        crafterSelect.appendChild(option);
      });
    }

    // Helper to determine if an item has any non-Smoldering tiers with values
    function hasNonSmolderingTier(item) {
      const tiers = ['Flickering','Shimmering','Sparkling','Glimmering','Luminous','Lambent','Scintillating'];
      return tiers.some(t => item[t] !== null && item[t] !== undefined);
    }

    function renderAdornmentsTable() {
      const slotFilter = document.getElementById('slotFilter').value;
      const tierFilter = document.getElementById('tierFilter').value;
      const keywordFilter = document.getElementById('keywordFilter').value.trim().toLowerCase();
      const crafterFilter = document.getElementById('crafterFilter').value;
      const tbody = document.getElementById('adornmentTable').querySelector('tbody');
      tbody.innerHTML = '';
      adornmentsData.forEach((item, idx) => {
        // Filter by slot
        if (slotFilter !== 'All' && item.slot !== slotFilter) return;
        // Filter by crafter
        if (crafterFilter !== 'All' && item.madeBy !== crafterFilter) return;
        // Keyword search across columns
        if (keywordFilter) {
          const combined = `${item.slot || ''} ${item.name || ''} ${item.madeBy || ''} ${item.stat || ''} ${item.quality || ''}`.toLowerCase();
          if (!combined.includes(keywordFilter)) return;
        }
        // Tier filter: only include items that have a value in the selected tier
        if (tierFilter !== 'All' && item[tierFilter] == null) return;
        // When ROK toggle is off (includeRok = false), hide items that only have a Smoldering value and no other tiers
        if (!includeRok && !hasNonSmolderingTier(item) && (item.Smoldering !== null && item.Smoldering !== undefined)) return;
        // Build table row
        const tr = document.createElement('tr');
        [item.slot, item.name, item.madeBy, item.stat].forEach(val => {
          const td = document.createElement('td');
          td.textContent = (val === null || val === undefined) ? '' : val;
          tr.appendChild(td);
        });
        const tierNames = ['Flickering','Shimmering','Sparkling','Glimmering','Luminous','Lambent','Scintillating','Smoldering'];
        tierNames.forEach(tierName => {
          const value = item[tierName];
          const td = document.createElement('td');
          td.classList.add('tier-cell');
          if (tierName === 'Smoldering') {
            td.classList.add('smoldering-col');
          }
          if (value !== null && value !== undefined) {
            td.dataset.idx = idx;
            td.dataset.tier = tierName;
            td.dataset.quality = item.quality.toLowerCase();
            const valueSpan = document.createElement('span');
            valueSpan.className = 'cell-value';
            valueSpan.textContent = value;
            td.appendChild(valueSpan);
            const countBadge = document.createElement('span');
            countBadge.className = 'cell-count';
            countBadge.dataset.idx = idx;
            countBadge.dataset.tier = tierName;
            td.appendChild(countBadge);
            td.addEventListener('mousedown', function(e) {
              e.preventDefault();
              if (e.button === 0) {
                addItemToCart(idx, tierName);
              } else if (e.button === 2) {
                removeItemFromCart(idx, tierName);
              }
            });
            td.addEventListener('contextmenu', function(e) {
              e.preventDefault();
            });
          } else {
            td.textContent = '';
            td.style.cursor = 'default';
          }
          tr.appendChild(td);
        });
        const qualityTd = document.createElement('td');
        qualityTd.textContent = (item.quality === null || item.quality === undefined) ? '' : item.quality;
        tr.appendChild(qualityTd);
        tbody.appendChild(tr);
      });
    }

    function initCalculator() {
      const tbody = document.getElementById('calcTable').querySelector('tbody');
      transmutedData.forEach((tierData, index) => {
        const tr = document.createElement('tr');
        const tdName = document.createElement('td');
        tdName.textContent = 'T' + (index + 1) + ' ' + tierData.tier;
        tr.appendChild(tdName);
        ['treasured','legendary','fabled'].forEach(rarity => {
          const td = document.createElement('td');
          const input = document.createElement('input');
          input.type = 'number';
          input.min = 0;
          input.value = 0;
          input.dataset.tier = tierData.tier;
          input.dataset.rarity = rarity;
          input.addEventListener('input', calculateResults);
          td.appendChild(input);
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    function calculateResults() {
      const totals = { powder: 0, fragment: 0, infusion: 0, mana: 0 };
      const breakdown = { powder: {}, fragment: {}, infusion: {}, mana: {} };
      const LOW_EXPECTED = 0.8;
      const HIGH_EXPECTED = 0.25;
      const inputs = document.querySelectorAll('#calcTable input');
      inputs.forEach(input => {
          const rarity = input.dataset.rarity;
          const tierName = input.dataset.tier;
          const count = parseFloat(input.value) || 0;
          if (count <= 0) return;
          const tierInfo = transmutedData.find(t => t.tier === tierName);
          if (!tierInfo) return;
          let lowKey, highKey;
          if (rarity === 'treasured') { lowKey = 'fragment'; highKey = 'powder'; }
          else if (rarity === 'legendary') { lowKey = 'powder'; highKey = 'infusion'; }
          else if (rarity === 'fabled') { lowKey = 'infusion'; highKey = 'mana'; }
          const rarityInfo = tierInfo[rarity] || {};
          const lowCount = rarityInfo[lowKey] ? 1 : 0;
          const highCount = rarityInfo[highKey] ? 1 : 0;
          const lowYield = lowCount * LOW_EXPECTED * count;
          const highYield = highCount * HIGH_EXPECTED * count;
          totals[lowKey] += lowYield;
          totals[highKey] += highYield;
          breakdown[lowKey][tierName] = (breakdown[lowKey][tierName] || 0) + lowYield;
          breakdown[highKey][tierName] = (breakdown[highKey][tierName] || 0) + highYield;
      });
      renderResults(totals, breakdown);
    }

    function renderResults(totals, breakdown) {
      const resultsDiv = document.getElementById('calcResults');
      resultsDiv.innerHTML = '';
      const resources = [ { name: 'Fragments', key: 'fragment' }, { name: 'Powders', key: 'powder' }, { name: 'Infusions', key: 'infusion' }, { name: 'Manas', key: 'mana' } ];
      resources.forEach(res => {
        const card = document.createElement('div');
        card.className = 'result-card';
        const h3 = document.createElement('h3');
        h3.textContent = res.name;
        card.appendChild(h3);
        const pTotal = document.createElement('p');
        const totalValue = totals[res.key] || 0;
        pTotal.textContent = totalValue.toFixed(2);
        card.appendChild(pTotal);
        const tiersBreakdown = breakdown[res.key] || {};
        const entries = Object.keys(tiersBreakdown).filter(t => tiersBreakdown[t] > 0);
        if (entries.length > 0) {
          const ul = document.createElement('ul');
          entries.sort((a, b) => {
            const ia = transmutedData.findIndex(t => t.tier === a);
            const ib = transmutedData.findIndex(t => t.tier === b);
            return ia - ib;
          });
          entries.forEach(tierName => {
            const tierIndex = transmutedData.findIndex(t => t.tier === tierName);
            const count = tiersBreakdown[tierName] || 0;
            const materialName = materialData[tierIndex].materials[res.key].name;
            const li = document.createElement('li');
            li.textContent = count.toFixed(2) + ' ' + materialName + ' (T' + (tierIndex + 1) + ')';
            ul.appendChild(li);
          });
          card.appendChild(ul);
        }
        resultsDiv.appendChild(card);
      });
    }

    function copyCraftingListToClipboard() {
      const lines = [];
      const grouped = {};
      adornmentsData.forEach((item, idx) => {
        const counts = itemCountsByTier[idx];
        if (!counts) return;
        const crafter = item.madeBy || 'Unknown';
        Object.keys(counts).forEach(tierName => {
          const count = counts[tierName];
          if (count > 0) {
            const value = (item[tierName] !== null && item[tierName] !== undefined) ? item[tierName] : '';
            const statFormatted = item.stat ? item.stat.replace(/vs\./gi, 'Versus') : '';
            let detail;
            if (value !== '') {
              detail = `${item.slot}, ${value} ${statFormatted}`.trim();
            } else {
              detail = `${item.slot}${statFormatted ? ', ' + statFormatted : ''}`.trim();
            }
            const line = `${count} ${tierName} ${item.name} (${detail})`;
            if (!grouped[crafter]) grouped[crafter] = [];
            grouped[crafter].push(line);
          }
        });
      });
      const crafterNames = Object.keys(grouped).sort();
      if (crafterNames.length === 0) {
        lines.push('No adornments selected');
      } else {
        crafterNames.forEach(crafter => {
          lines.push(`### ${crafter}`);
          grouped[crafter].forEach(line => { lines.push(line); });
          lines.push('');
        });
        if (lines[lines.length - 1] === '') lines.pop();
      }
      lines.push('');
      lines.push('Materials:');
      const materialLines = [];
      materialsCartTotals.forEach((totals, tierIndex) => {
        const tierInfo = materialData[tierIndex];
        ['mana','infusion','powder','fragment'].forEach(matKey => {
          const count = totals[matKey] || 0;
          if (count > 0) {
            const baseName = tierInfo.materials[matKey].name;
            let fullName;
            if (matKey === 'infusion') fullName = `Infusion of ${baseName}`;
            else if (matKey === 'powder') fullName = `${baseName} Powder`;
            else if (matKey === 'fragment') fullName = `${baseName} Fragment`;
            else if (matKey === 'mana') fullName = `${baseName} Mana`;
            else fullName = baseName;
            materialLines.push(`${count} ${fullName} (T${tierIndex + 1})`);
          }
        });
      });
      if (materialLines.length === 0) {
        lines.push('No materials required');
      } else {
        lines.push(...materialLines);
      }
      const text = lines.join('\n');
      const copyHelper = (str) => {
        const textarea = document.createElement('textarea');
        textarea.value = str;
        document.body.appendChild(textarea);
        textarea.select();
        try { document.execCommand('copy'); alert('Exported crafting list copied to clipboard'); }
        catch (err) { alert('Unable to copy to clipboard'); }
        document.body.removeChild(textarea);
      };
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => { alert('Exported crafting list copied to clipboard'); }).catch(() => { copyHelper(text); });
      } else {
        copyHelper(text);
      }
    }

    function openTooltip(text) {
      const overlay = document.getElementById('tooltipOverlay');
      const contentDiv = document.getElementById('tooltipContent');
      contentDiv.textContent = text;
      overlay.onclick = function(e) {
        if (e.target.id === 'tooltipOverlay' || e.target.classList.contains('close-btn')) closeTooltip();
      };
      const closeBtn = overlay.querySelector('.close-btn');
      if (closeBtn) {
        closeBtn.onclick = function(e) { e.stopPropagation(); closeTooltip(); };
      }
      overlay.style.display = 'block';
    }
    function closeTooltip() {
      const overlay = document.getElementById('tooltipOverlay');
      overlay.style.display = 'none';
    }

    window.addEventListener('DOMContentLoaded', () => {
      initFilters();
      initCalculator();
      renderAdornmentsTable();
      calculateResults();
      document.getElementById('slotFilter').addEventListener('change', renderAdornmentsTable);
      document.getElementById('tierFilter').addEventListener('change', renderAdornmentsTable);
      document.getElementById('keywordFilter').addEventListener('input', renderAdornmentsTable);
      document.getElementById('crafterFilter').addEventListener('change', renderAdornmentsTable);
      renderCraftingSummary();
      const exportBtn = document.getElementById('exportButton');
      if (exportBtn) exportBtn.addEventListener('click', copyCraftingListToClipboard);
      document.addEventListener('click', function(event) {
        const t = event.target;
        if (t && t.classList && t.classList.contains('remove-item')) return;
      });
      document.querySelectorAll('.info-icon').forEach(icon => {
        icon.addEventListener('click', (e) => {
          e.stopPropagation();
          const message = icon.getAttribute('data-tooltip') || '';
          openTooltip(message);
        });
      });
      const calcHeaderEl = document.getElementById('calc-header');
      const calcSectionEl = document.getElementById('calculator-section');
      if (calcHeaderEl && calcSectionEl) {
        calcHeaderEl.addEventListener('click', (e) => {
          if (e.target.classList.contains('info-icon')) return;
          calcSectionEl.classList.toggle('collapsed');
        });
      }
      // ROK toggle: include or exclude the Rise of Kunark dataset (Tier 8).  When unchecked,
      // adornments that only have a Smoldering value are filtered out and the Smoldering column is hidden entirely.
      const rokToggle = document.getElementById('rokToggle');
      rokToggle.addEventListener('change', function() {
        includeRok = this.checked;
        // Toggle the class to hide or show the Smoldering column
        document.body.classList.toggle('hide-smoldering', !includeRok);
        renderAdornmentsTable();
      });
    });
  </script>
</body>
</html>
